/*! ics.js Sat Jun 11 2016 13:48:30 */
!function (a) {
    "use strict";
    if (a.URL = a.URL || a.webkitURL, a.Blob && a.URL)try {
        return void new Blob
    } catch (b) {
    }
    var c = a.BlobBuilder || a.WebKitBlobBuilder || a.MozBlobBuilder || function (a) {
            var b = function (a) {
                return Object.prototype.toString.call(a).match(/^\[object\s(.*)\]$/)[1]
            }, c = function () {
                this.data = []
            }, d = function (a, b, c) {
                this.data = a, this.size = a.length, this.type = b, this.encoding = c
            }, e = c.prototype, f = d.prototype, g = a.FileReaderSync, h = function (a) {
                this.code = this[this.name = a]
            }, i = "NOT_FOUND_ERR SECURITY_ERR ABORT_ERR NOT_READABLE_ERR ENCODING_ERR NO_MODIFICATION_ALLOWED_ERR INVALID_STATE_ERR SYNTAX_ERR".split(" "), j = i.length, k = a.URL || a.webkitURL || a, l = k.createObjectURL, m = k.revokeObjectURL, n = k, o = a.btoa, p = a.atob, q = a.ArrayBuffer, r = a.Uint8Array, s = /^[\w-]+:\/*\[?[\w\.:-]+\]?(?::[0-9]+)?/;
            for (d.fake = f.fake = !0; j--;)h.prototype[i[j]] = j + 1;
            return k.createObjectURL || (n = a.URL = function (a) {
                var b, c = document.createElementNS("http://www.w3.org/1999/xhtml", "a");
                return c.href = a, "origin" in c || ("data:" === c.protocol.toLowerCase() ? c.origin = null : (b = a.match(s), c.origin = b && b[1])), c
            }), n.createObjectURL = function (a) {
                var b, c = a.type;
                return null === c && (c = "application/octet-stream"), a instanceof d ? (b = "data:" + c, "base64" === a.encoding ? b + ";base64," + a.data : "URI" === a.encoding ? b + "," + decodeURIComponent(a.data) : o ? b + ";base64," + o(a.data) : b + "," + encodeURIComponent(a.data)) : l ? l.call(k, a) : void 0
            }, n.revokeObjectURL = function (a) {
                "data:" !== a.substring(0, 5) && m && m.call(k, a)
            }, e.append = function (a) {
                var c = this.data;
                if (r && (a instanceof q || a instanceof r)) {
                    for (var e = "", f = new r(a), i = 0, j = f.length; j > i; i++)e += String.fromCharCode(f[i]);
                    c.push(e)
                } else if ("Blob" === b(a) || "File" === b(a)) {
                    if (!g)throw new h("NOT_READABLE_ERR");
                    var k = new g;
                    c.push(k.readAsBinaryString(a))
                } else a instanceof d ? "base64" === a.encoding && p ? c.push(p(a.data)) : "URI" === a.encoding ? c.push(decodeURIComponent(a.data)) : "raw" === a.encoding && c.push(a.data) : ("string" != typeof a && (a += ""), c.push(unescape(encodeURIComponent(a))))
            }, e.getBlob = function (a) {
                return arguments.length || (a = null), new d(this.data.join(""), a, "raw")
            }, e.toString = function () {
                return "[object BlobBuilder]"
            }, f.slice = function (a, b, c) {
                var e = arguments.length;
                return 3 > e && (c = null), new d(this.data.slice(a, e > 1 ? b : this.data.length), c, this.encoding)
            }, f.toString = function () {
                return "[object Blob]"
            }, f.close = function () {
                this.size = 0, delete this.data
            }, c
        }(a);
    a.Blob = function (a, b) {
        var d = b ? b.type || "" : "", e = new c;
        if (a)for (var f = 0, g = a.length; g > f; f++)Uint8Array && a[f] instanceof Uint8Array ? e.append(a[f].buffer) : e.append(a[f]);
        var h = e.getBlob(d);
        return !h.slice && h.webkitSlice && (h.slice = h.webkitSlice), h
    };
    var d = Object.getPrototypeOf || function (a) {
            return a.__proto__
        };
    a.Blob.prototype = d(new a.Blob)
}("undefined" != typeof self && self || "undefined" != typeof window && window || this.content || this);
var saveAs = saveAs || function (a) {
        "use strict";
        if (!("undefined" == typeof a || "undefined" != typeof navigator && /MSIE [1-9]\./.test(navigator.userAgent))) {
            var b = a.document, c = function () {
                return a.URL || a.webkitURL || a
            }, d = b.createElementNS("http://www.w3.org/1999/xhtml", "a"), e = "download" in d, f = function (a) {
                var b = new MouseEvent("click");
                a.dispatchEvent(b)
            }, g = /constructor/i.test(a.HTMLElement), h = function (b) {
                (a.setImmediate || a.setTimeout)(function () {
                    throw b
                }, 0)
            }, i = "application/octet-stream", j = 4e4, k = function (a) {
                var b = function () {
                    "string" == typeof a ? c().revokeObjectURL(a) : a.remove()
                };
                setTimeout(b, j)
            }, l = function (a, b, c) {
                b = [].concat(b);
                for (var d = b.length; d--;) {
                    var e = a["on" + b[d]];
                    if ("function" == typeof e)try {
                        e.call(a, c || a)
                    } catch (f) {
                        h(f)
                    }
                }
            }, m = function (a) {
                return /^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type) ? new Blob([String.fromCharCode(65279), a], {type: a.type}) : a
            }, n = function (b, h, j) {
                j || (b = m(b));
                var n, o = this, p = b.type, q = p === i, r = function () {
                    l(o, "writestart progress write writeend".split(" "))
                }, s = function () {
                    if (q && g && a.FileReader) {
                        var d = new FileReader;
                        return d.onloadend = function () {
                            var b = d.result;
                            a.location.href = "data:attachment/file" + b.slice(b.search(/[,;]/)), o.readyState = o.DONE, r()
                        }, d.readAsDataURL(b), void(o.readyState = o.INIT)
                    }
                    if (n || (n = c().createObjectURL(b)), q)a.location.href = n; else {
                        var e = a.open(n, "_blank");
                        e || (a.location.href = n)
                    }
                    o.readyState = o.DONE, r(), k(n)
                };
                return o.readyState = o.INIT, e ? (n = c().createObjectURL(b), void setTimeout(function () {
                    d.href = n, d.download = h, f(d), r(), k(n), o.readyState = o.DONE
                })) : void s()
            }, o = n.prototype, p = function (a, b, c) {
                return new n(a, b || a.name || "download", c)
            };
            return "undefined" != typeof navigator && navigator.msSaveOrOpenBlob ? function (a, b, c) {
                return b = b || a.name || "download", c || (a = m(a)), navigator.msSaveOrOpenBlob(a, b)
            } : (o.abort = function () {
            }, o.readyState = o.INIT = 0, o.WRITING = 1, o.DONE = 2, o.error = o.onwritestart = o.onprogress = o.onwrite = o.onabort = o.onerror = o.onwriteend = null, p)
        }
    }("undefined" != typeof self && self || "undefined" != typeof window && window || this.content);
"undefined" != typeof module && module.exports ? module.exports.saveAs = saveAs : "undefined" != typeof define && null !== define && null !== define.amd && define([], function () {
    return saveAs
});
var ics = function () {
    "use strict";
    if (navigator.userAgent.indexOf("MSIE") > -1 && -1 == navigator.userAgent.indexOf("MSIE 10"))return void console.log("Unsupported Browser");
    var a = -1 !== navigator.appVersion.indexOf("Win") ? "\r\n" : "\n", b = [], c = ["BEGIN:VCALENDAR", "VERSION:2.0"].join(a), d = a + "END:VCALENDAR", e = ["SU", "MO", "TU", "WE", "TH", "FR", "SA"];
    return {
        events: function () {
            return b
        }, calendar: function () {
            return c + a + b.join(a) + d
        }, addEvent: function (c, d, f, g, h, i) {
            if ("undefined" == typeof c || "undefined" == typeof d || "undefined" == typeof f || "undefined" == typeof g || "undefined" == typeof h)return !1;
            if (i && !i.rule) {
                if ("YEARLY" !== i.freq && "MONTHLY" !== i.freq && "WEEKLY" !== i.freq && "DAILY" !== i.freq)throw"Recurrence rule frequency must be provided and be one of the following: 'YEARLY', 'MONTHLY', 'WEEKLY', or 'DAILY'";
                if (i.until && isNaN(Date.parse(i.until)))throw"Recurrence rule 'until' must be a valid date string";
                if (i.interval && isNaN(parseInt(i.interval)))throw"Recurrence rule 'interval' must be an integer";
                if (i.count && isNaN(parseInt(i.count)))throw"Recurrence rule 'count' must be an integer";
                if ("undefined" != typeof i.byday) {
                    if ("[object Array]" !== Object.prototype.toString.call(i.byday))throw"Recurrence rule 'byday' must be an array";
                    if (i.byday.length > 7)throw"Recurrence rule 'byday' array must not be longer than the 7 days in a week";
                    i.byday = i.byday.filter(function (a, b) {
                        return i.byday.indexOf(a) == b
                    });
                    for (var j in i.byday)if (e.indexOf(i.byday[j]) < 0)throw"Recurrence rule 'byday' values must include only the following: 'SU', 'MO', 'TU', 'WE', 'TH', 'FR', 'SA'"
                }
            }
            var k = new Date(g), l = new Date(h), m = ("0000" + k.getFullYear().toString()).slice(-4), n = ("00" + (k.getMonth() + 1).toString()).slice(-2), o = ("00" + k.getDate().toString()).slice(-2), p = ("00" + k.getHours().toString()).slice(-2), q = ("00" + k.getMinutes().toString()).slice(-2), r = ("00" + k.getSeconds().toString()).slice(-2), s = ("0000" + l.getFullYear().toString()).slice(-4), t = ("00" + (l.getMonth() + 1).toString()).slice(-2), u = ("00" + l.getDate().toString()).slice(-2), v = ("00" + l.getHours().toString()).slice(-2), w = ("00" + l.getMinutes().toString()).slice(-2), x = ("00" + l.getSeconds().toString()).slice(-2), y = "", z = "";
            q + r + w + x !== 0 && (y = "T" + p + q + r, z = "T" + v + w + x);
            var A, B = m + n + o + y, C = s + t + u + z;
            if (i)if (i.rule)A = i.rule; else {
                if (A = "RRULE:FREQ=" + i.freq, i.until) {
                    var D = new Date(Date.parse(i.until)).toISOString();
                    A += ";UNTIL=" + D.substring(0, D.length - 13).replace(/[-]/g, "") + "000000Z"
                }
                i.interval && (A += ";INTERVAL=" + i.interval), i.count && (A += ";COUNT=" + i.count), i.byday && i.byday.length > 0 && (A += ";BYDAY=" + i.byday.join(","))
            }
            var E = (new Date).toISOString(), F = ["BEGIN:VEVENT", "CLASS:PUBLIC", "DESCRIPTION:" + d.replace("\r\n", "\\n"), "DTSTART:" + B, "DTEND:" + C, "DTSTAMP:" + E.substring(0, E.length - 13).replace(/[-]/g, "") + "000000Z", "LOCATION:" + f, "SUMMARY;LANGUAGE=en-us:" + c, "TRANSP:TRANSPARENT", "END:VEVENT"];
            return A && F.splice(4, 0, A), F = F.join(a), b.push(F), F
        }, download: function (e, f) {
            if (b.length < 1)return !1;
            f = "undefined" != typeof f ? f : ".ics", e = "undefined" != typeof e ? e : "calendar";
            var g, h = c + a + b.join(a) + d;
            if (-1 === navigator.userAgent.indexOf("MSIE 10"))g = new Blob([h]); else {
                var i = new BlobBuilder;
                i.append(h), g = i.getBlob("text/x-vCalendar;charset=" + document.characterSet)
            }
            return saveAs(g, e + f), h
        }
    }
};
module.exports = ics;